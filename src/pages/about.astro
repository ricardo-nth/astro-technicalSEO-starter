---
// Import layout
import SiteLayout from '@/layouts/SiteLayout.astro';

// Import components
import Welcome from '@/components/sections/Welcome.astro';
import CompanyOverview from '@/components/sections/CompanyOverview.astro';
import TeamOverview from '@/components/sections/TeamOverview.astro';
import EnhancedSchema from '@/components/seo/EnhancedSchema.astro';

// Import page content from Content Collections
import { getEntry } from 'astro:content';
import { getCompanyInfo, getFeaturedTeamMembers } from '@/utils/content.ts';

// Get page content and SEO data
const pageContent = await getEntry('pages', 'about');
const seoData = await getEntry('seo', 'about');

// Get business data for about page
const companyInfo = await getCompanyInfo();
const teamMembers = await getFeaturedTeamMembers();

// Extract data
const { hero } = pageContent?.data || {};
const {
  title,
  description,
  keywords,
  robots,
  author,
  schema,
} = seoData?.data || {};

// Page metadata
const metadata = {
  title: title || 'About - Technical SEO Starter',
  description: description || 'Learn about our technical SEO expertise',
  url: new URL(Astro.url.pathname, Astro.site).toString(),
  robots,
  author,
  keywords: keywords?.join(', '),
  ogType: 'website',
  siteName: 'Technical SEO Starter',
  twitterCard: 'summary_large_image',
};
---

<SiteLayout metadata={metadata}>
  <EnhancedSchema
    type={schema?.type || 'about'}
    title={title || 'About - Technical SEO Starter'}
    description={description || 'Learn about our technical SEO expertise'}
    url={new URL(Astro.url.pathname, Astro.site).toString()}
    author={author ? { name: author } : undefined}
    breadcrumbs={schema?.breadcrumbs}
  />
  
  <CompanyOverview company={companyInfo} />
  <TeamOverview teamMembers={teamMembers} />
</SiteLayout>
