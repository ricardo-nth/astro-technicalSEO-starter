---
// Import layout
import SiteLayout from '@/layouts/SiteLayout.astro';

// Import components
import StandardHero from '@/components/ui/StandardHero.astro';
import StandardCTA from '@/components/ui/StandardCTA.astro';
import ServicesOverview from '@/components/sections/ServicesOverview.astro';
import TestimonialsOverview from '@/components/sections/TestimonialsOverview.astro';
import EnhancedSchema from '@/components/seo/EnhancedSchema.astro';

// Import page content from Content Collections
import { getEntry } from 'astro:content';
import { getServices, getFeaturedTestimonials } from '@/utils/content.ts';

// Get page content and SEO data
const pageContent = await getEntry('pages', 'index');
const seoData = await getEntry('seo', 'index');

// Get business data for homepage
const servicesData = await getServices();
const testimonials = await getFeaturedTestimonials();

// Extract data
const { hero } = pageContent?.data || {};
const {
  title,
  description,
  keywords,
  ogImage,
  robots,
  author,
  datePublished,
  dateModified,
  schema,
} = seoData?.data || {};

// Page metadata
const metadata = {
  title: title || 'Technical SEO Starter',
  description: description || 'Professional Astro template for technical SEO',
  url: new URL(Astro.url.pathname, Astro.site).toString(),
  image: ogImage ? new URL(ogImage, Astro.site).toString() : undefined,
  robots,
  author,
  keywords: keywords?.join(', '),
  ogType: 'website',
  siteName: 'Technical SEO Starter',
  twitterCard: 'summary_large_image',
};
---

<SiteLayout metadata={metadata}>
  <EnhancedSchema
    type={schema?.type || 'webpage'}
    title={title || 'Technical SEO Starter'}
    description={description || 'Professional Astro template for technical SEO'}
    url={new URL(Astro.url.pathname, Astro.site).toString()}
    image={ogImage ? new URL(ogImage, Astro.site).toString() : undefined}
    author={author ? { name: author } : undefined}
    datePublished={datePublished}
    dateModified={dateModified}
    breadcrumbs={schema?.breadcrumbs}
    faqs={schema?.faqs}
    services={schema?.services}
  />
  
  <StandardHero 
    badge={{
      icon: "M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",
      text: "Technical SEO Experts"
    }}
    title="Elevate Your Digital Presence with Professional SEO Solutions"
    highlightText="Professional"
    description="Transform your website's performance with our cutting-edge technical SEO strategies. Built on modern web standards for maximum search engine visibility and user experience."
    stats={[
      {
        icon: "M13 10V3L4 14h7v7l9-11h-7z",
        number: "100%",
        label: "Performance Score",
        color: "blue"
      },
      {
        icon: "M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",
        number: "<1.5s",
        label: "LCP Score",
        color: "green"
      },
      {
        icon: "M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z",
        number: "Expert",
        label: "Level Team",
        color: "purple"
      }
    ]}
  />
  
  <ServicesOverview services={servicesData} />
  <TestimonialsOverview testimonials={testimonials} />
  
  <StandardCTA 
    badge={{
      icon: "M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z",
      text: "Get Started Today"
    }}
    title="Ready to Transform Your SEO Performance?"
    highlightText="Transform"
    description="Join hundreds of businesses that have boosted their search rankings and user experience with our technical SEO expertise. Let's build something amazing together."
    buttons={[
      {
        text: "Start Your Project",
        href: "/contact",
        type: "primary",
        icon: "M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"
      },
      {
        text: "View Our Services",
        href: "/services",
        type: "secondary",
        icon: "M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
      }
    ]}
  />
</SiteLayout>
